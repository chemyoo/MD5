var progressbar=document.getElementsByClassName("\x70\x72\x6f\x67\x72\x65\x73\x73\x62\x61\x72")[0x0];var uploadfile=document.getElementById('\x66\x69\x6c\x65\x69\x6e\x70\x75\x74');var percent=document.getElementById("\x70\x65\x72\x63\x65\x6e\x74");function get_filemd5sum(ofile){var file=ofile;var tmp_md5;var blobSlice=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,chunkSize=0x7b8d80,chunks=Math.ceil(file.size/chunkSize),currentChunk=0x0,spark=new SparkMD5.ArrayBuffer(),fileReader=new FileReader(),md5_progress=0x0;fileReader.onload=function(e){spark.append(e.target.result);currentChunk++;if(chunks==0x0){chunks=currentChunk};md5_progress=Math.floor((currentChunk/chunks)*0x64);percent.innerText=md5_progress+"\x25";console.log(file.name+"\x20\x20\u6b63\u5728\u5904\u7406\uff0c\u8bf7\u7a0d\u7b49\x2c"+"\u5df2\u5b8c\u6210"+md5_progress+"\x25");var handler_info=document.getElementById("\x68\x61\x6e\x64\x6c\x65\x72\x5f\x69\x6e\x66\x6f");handler_info.innerHTML=file.name+"\x20\x20\u6b63\u5728\u5904\u7406\uff0c\u8bf7\u7a0d\u7b49\x2c"+"\u5df2\u5b8c\u6210"+md5_progress+"\x25";progressbar.value=md5_progress;if(currentChunk<chunks){loadNext()}else{tmp_md5=spark.end();console.log(tmp_md5);handler_info.innerHTML=file.name+"\u7684\x4d\x44\x35\u503c\u662f\uff1a"+tmp_md5}};fileReader.onerror=function(){console.warn('\x6f\x6f\x70\x73\x2c\x20\x73\x6f\x6d\x65\x74\x68\x69\x6e\x67\x20\x77\x65\x6e\x74\x20\x77\x72\x6f\x6e\x67\x2e')};function loadNext(){var start=currentChunk*chunkSize,end=((start+chunkSize)>=file.size)?file.size:start+chunkSize;fileReader.readAsArrayBuffer(blobSlice.call(file,start,end))};loadNext()};uploadfile.onchange=function(e){reset();var file=this.files[0x0];if(!file){alert('\u8bf7\u9009\u62e9\u6587\u4ef6\uff01');return false};get_filemd5sum(file)};var reset=function(){progressbar.value=0x0;percent.innerText="\x30\x25"}